(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[127],{21481:function(e,s,a){Promise.resolve().then(a.bind(a,44497))},44497:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return I}});var t=a(15444),r=a(89300),i=a(75762),n=a(79047),l=a(99827),c=a(2422),d=a(61335),o=a(56948),m=a(70362),x=a(19484),u=a(35798),h=a(58510),f=a(70691),g=a(66124),j=a(77694),p=a(25422),y=a(6488),b=a(52429),N=a(26584),v=a(25052),w=a(65522);let k=r.forwardRef(({className:e,value:s,...a},r)=>(0,t.jsx)(v.fC,{ref:r,className:(0,w.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...a,children:(0,t.jsx)(v.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));k.displayName=v.fC.displayName;var S=a(66772);function Z({securitySettings:e,onStepComplete:s,className:a=""}){let{data:n}=(0,i.useSession)(),[o,m]=(0,r.useState)(0),f=[{step:1,title:"Email Verification",description:"Verify your email address to secure your account",completed:e.emailVerified,required:!0},{step:2,title:"Phone Verification",description:"Add and verify your phone number for SMS notifications",completed:e.phoneVerified,required:!0},{step:3,title:"Two-Factor Authentication",description:"Enable 2FA for enhanced security using an authenticator app",completed:e.twoFaEnabled,required:!0}];(0,r.useEffect)(()=>{let e=f.findIndex(e=>!e.completed);m(-1===e?f.length:e)},[e]);let j=(e,s)=>{if(e.completed)return(0,t.jsx)(g.Z,{className:"h-6 w-6 text-green-500"});if(s===o)return(0,t.jsx)(S.Z,{className:"h-6 w-6 text-yellow-500"});switch(e.step){case 1:return(0,t.jsx)(u.Z,{className:"h-6 w-6 text-gray-400"});case 2:return(0,t.jsx)(h.Z,{className:"h-6 w-6 text-gray-400"});case 3:return(0,t.jsx)(x.Z,{className:"h-6 w-6 text-gray-400"});default:return(0,t.jsx)(S.Z,{className:"h-6 w-6 text-gray-400"})}},p=(e,s)=>e.completed?(0,t.jsx)(d.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Completed"}):s===o?(0,t.jsx)(d.C,{variant:"default",className:"bg-yellow-100 text-yellow-800",children:"In Progress"}):(0,t.jsx)(d.C,{variant:"secondary",children:"Pending"}),y=f.filter(e=>e.completed).length,b=y/f.length*100,N=e=>{s(e)};return"complete"===e.verificationStep?(0,t.jsx)(l.Zb,{className:`border-green-200 bg-green-50 ${a}`,children:(0,t.jsxs)(l.aY,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)(g.Z,{className:"h-8 w-8 text-green-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-800",children:"Security Setup Complete!"}),(0,t.jsx)("p",{className:"text-sm text-green-600",children:"Your account is fully secured with all verification methods enabled."})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 text-green-500"}),(0,t.jsx)("span",{children:"Email Verified"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 text-green-500"}),(0,t.jsx)("span",{children:"Phone Verified"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 text-green-500"}),(0,t.jsx)("span",{children:"2FA Enabled"})]})]})]})}):(0,t.jsxs)(l.Zb,{className:a,children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-5 w-5"}),"Security Setup"]}),(0,t.jsx)(l.SZ,{children:"Complete these steps to secure your account"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Progress"}),(0,t.jsxs)("span",{children:[y," of ",f.length," completed"]})]}),(0,t.jsx)(k,{value:b,className:"h-2"})]})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[f.map((e,s)=>(0,t.jsxs)("div",{className:`flex items-center gap-4 p-4 rounded-lg border transition-colors ${s===o?"border-blue-200 bg-blue-50":e.completed?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:j(e,s)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h4",{className:"font-medium text-sm",children:e.title}),p(e,s)]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),!e.completed&&s===o&&(0,t.jsx)(c.z,{size:"sm",onClick:()=>{switch(e.step){case 1:N("email");break;case 2:N("phone");break;case 3:N("2fa")}},className:"flex-shrink-0",children:1===e.step?"Verify Email":2===e.step?"Verify Phone":"Setup 2FA"})]},e.step)),o>=f.length&&(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)(g.Z,{className:"h-12 w-12 text-green-500 mx-auto mb-3"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"All Set!"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Your account security is fully configured. You can access all features now."})]})]})]})}var C=a(74678),A=a(34635),E=a(55404),V=a(1804),F=a(91585),z=a(48001);function R({onComplete:e,onCancel:s}){let[a,i]=(0,r.useState)("generate"),[n,u]=(0,r.useState)(""),[h,f]=(0,r.useState)(""),[j,p]=(0,r.useState)([]),[y,b]=(0,r.useState)(""),[v,w]=(0,r.useState)(!1),[k,S]=(0,r.useState)(""),Z=async()=>{w(!0),S("");try{let e=await fetch("/api/auth/setup-2fa",{method:"GET"}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to generate 2FA setup");u(s.qrCodeUrl),f(s.secret),p(s.backupCodes),i("verify")}catch(e){console.error("2FA generation error:",e),S(e instanceof Error?e.message:"Failed to generate 2FA setup")}finally{w(!1)}},R=async()=>{if(!y||6!==y.length){S("Please enter a valid 6-digit code");return}w(!0),S("");try{let e=await fetch("/api/auth/setup-2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:y})}),s=await e.json();if(!e.ok)throw Error(s.error||"Invalid verification code");i("backup"),F.Am.success("2FA enabled successfully!")}catch(e){console.error("2FA verification error:",e),S(e instanceof Error?e.message:"Verification failed")}finally{w(!1)}};return(0,r.useEffect)(()=>{Z()},[]),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,t.jsxs)("div",{className:`flex items-center ${"generate"===a||"verify"===a?"text-blue-600":"text-gray-400"}`,children:[(0,t.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${"generate"===a||"verify"===a?"border-blue-600 bg-blue-50":"border-gray-300"}`,children:"generate"!==a&&"verify"!==a?(0,t.jsx)(g.Z,{className:"w-5 h-5 text-green-600"}):(0,t.jsx)("span",{className:"text-sm font-medium",children:"1"})}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Setup"})]}),(0,t.jsx)("div",{className:`w-8 h-0.5 ${"backup"===a||"complete"===a?"bg-blue-600":"bg-gray-300"}`}),(0,t.jsxs)("div",{className:`flex items-center ${"backup"===a?"text-blue-600":"complete"===a?"text-green-600":"text-gray-400"}`,children:[(0,t.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${"backup"===a?"border-blue-600 bg-blue-50":"complete"===a?"border-green-600 bg-green-50":"border-gray-300"}`,children:"complete"===a?(0,t.jsx)(g.Z,{className:"w-5 h-5 text-green-600"}):(0,t.jsx)("span",{className:"text-sm font-medium",children:"2"})}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Backup Codes"})]})]}),("generate"===a||"verify"===a)&&(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(E.Z,{className:"h-5 w-5"}),"generate"===a?"Setting up 2FA...":"Scan QR Code"]}),(0,t.jsx)(l.SZ,{children:"generate"===a?"Please wait while we generate your 2FA setup...":"Use your authenticator app to scan the QR code below"})]}),(0,t.jsxs)(l.aY,{className:"space-y-6",children:[k&&(0,t.jsxs)(o.bZ,{variant:"destructive",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)(o.X,{children:k})]}),"verify"===a&&n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:(0,t.jsx)(z.default,{src:n,alt:"2FA QR Code",width:200,height:200,className:"rounded"})})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A._,{className:"text-sm font-medium",children:"Can't scan? Enter this code manually:"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("code",{className:"flex-1 p-2 bg-gray-100 rounded text-sm font-mono break-all",children:h}),(0,t.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(h),F.Am.success("Secret copied to clipboard")},children:(0,t.jsx)(V.Z,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)(o.bZ,{children:[(0,t.jsx)(x.Z,{className:"h-4 w-4"}),(0,t.jsxs)(o.X,{className:"text-sm",children:[(0,t.jsx)("strong",{children:"Recommended apps:"})," Google Authenticator, Authy, Microsoft Authenticator, or 1Password. After scanning, enter the 6-digit code from your app below."]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(A._,{htmlFor:"verification-code",children:"Enter verification code from your app"}),(0,t.jsx)(C.I,{id:"verification-code",placeholder:"000000",value:y,onChange:e=>{b(e.target.value.replace(/\D/g,"").slice(0,6)),S("")},className:"text-center text-lg tracking-widest",maxLength:6}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.z,{onClick:R,disabled:v||6!==y.length,className:"flex-1",children:v?"Verifying...":"Verify & Enable 2FA"}),(0,t.jsx)(c.z,{variant:"outline",onClick:s,children:"Cancel"})]})]})]})]})]}),"backup"===a&&(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(N.Z,{className:"h-5 w-5"}),"Save Your Backup Codes"]}),(0,t.jsx)(l.SZ,{children:"These codes can be used to access your account if you lose your authenticator device. Each code can only be used once."})]}),(0,t.jsxs)(l.aY,{className:"space-y-6",children:[(0,t.jsxs)(o.bZ,{children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsxs)(o.X,{children:[(0,t.jsx)("strong",{children:"Important:"})," Store these codes in a safe place. You won't be able to see them again."]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-50 rounded-lg",children:j.map((e,s)=>(0,t.jsx)("code",{className:"text-sm font-mono text-center p-2 bg-white rounded border",children:e},s))}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(c.z,{onClick:()=>{let e=new Blob([`Naggery Backup Codes

These codes can be used to access your account if you lose your phone.
Each code can only be used once.

${j.join("\n")}

Keep these codes safe and secure!`],{type:"text/plain"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="naggery-backup-codes.txt",a.click(),URL.revokeObjectURL(s),F.Am.success("Backup codes downloaded")},variant:"outline",className:"flex-1",children:[(0,t.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Download Codes"]}),(0,t.jsxs)(c.z,{onClick:()=>{navigator.clipboard.writeText(j.join(", ")),F.Am.success("Backup codes copied to clipboard")},variant:"outline",className:"flex-1",children:[(0,t.jsx)(V.Z,{className:"h-4 w-4 mr-2"}),"Copy Codes"]})]}),(0,t.jsx)(c.z,{onClick:()=>{i("complete"),setTimeout(()=>{e?.()},2e3)},className:"w-full",children:"I've Saved My Backup Codes"})]})]}),"complete"===a&&(0,t.jsx)(l.Zb,{className:"border-green-200 bg-green-50",children:(0,t.jsxs)(l.aY,{className:"pt-6 text-center",children:[(0,t.jsx)(g.Z,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"2FA Setup Complete!"}),(0,t.jsx)("p",{className:"text-sm text-green-600 mb-4",children:"Your account is now protected with two-factor authentication."}),(0,t.jsx)(d.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Security Enhanced"})]})})]})}var P=a(90185),O=a(62492);function T({phone:e,onComplete:s,onCancel:a}){let[i,n]=(0,r.useState)("phone"),[d,x]=(0,r.useState)(e||""),[u,f]=(0,r.useState)(""),[j,p]=(0,r.useState)(!1),[y,b]=(0,r.useState)(""),[N,v]=(0,r.useState)(""),[w,k]=(0,r.useState)(0),S=e=>{let s=e.replace(/[^\d+]/g,"");return s.startsWith("+")?s:s?`+1${s}`:""},Z=async(e=d)=>{if(!e){b("Phone number is required");return}let s=S(e);if(!/^\+[1-9]\d{1,14}$/.test(s)){b("Invalid phone number format. Please include country code (e.g., +1234567890)");return}p(!0),b("");try{let e=await fetch("/api/auth/verify-sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:s})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to send verification code");x(s),n("verify"),k(60);let t=setInterval(()=>{k(e=>e<=1?(clearInterval(t),0):e-1)},1e3);F.Am.success(`Verification code sent to ${a.maskedPhone}`)}catch(e){console.error("SMS sending error:",e),b(e instanceof Error?e.message:"Failed to send verification code")}finally{p(!1)}},E=async()=>{if(!u||6!==u.length){b("Please enter a valid 6-digit code");return}p(!0),b("");try{let e=await fetch("/api/auth/verify-sms",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:N,code:u})}),a=await e.json();if(!e.ok)throw Error(a.error||"Invalid verification code");n("complete"),F.Am.success("Phone number verified successfully!"),setTimeout(()=>{s?.()},2e3)}catch(e){console.error("SMS verification error:",e),b(e instanceof Error?e.message:"Verification failed")}finally{p(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:["phone"===i&&(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-5 w-5"}),"Phone Verification"]}),(0,t.jsx)(l.SZ,{children:"Enter your phone number to receive a verification code via SMS"})]}),(0,t.jsx)(l.aY,{children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),Z()},className:"space-y-4",children:[y&&(0,t.jsxs)(o.bZ,{variant:"destructive",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)(o.X,{children:y})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A._,{htmlFor:"phone",children:"Phone Number"}),(0,t.jsx)(C.I,{id:"phone",type:"tel",placeholder:"+1234567890",value:d,onChange:e=>{x(S(e.target.value)),b("")},className:"text-lg"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Include country code (e.g., +1 for US, +44 for UK)"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.z,{type:"submit",disabled:j||!d,className:"flex-1",children:j?"Sending...":"Send Verification Code"}),(0,t.jsx)(c.z,{type:"button",variant:"outline",onClick:a,children:"Cancel"})]})]})})]}),"verify"===i&&(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(P.Z,{className:"h-5 w-5"}),"Enter Verification Code"]}),(0,t.jsxs)(l.SZ,{children:["We sent a 6-digit code to ",d,". Enter it below to verify your phone number."]})]}),(0,t.jsx)(l.aY,{children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),E()},className:"space-y-4",children:[y&&(0,t.jsxs)(o.bZ,{variant:"destructive",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)(o.X,{children:y})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A._,{htmlFor:"verification-code",children:"Verification Code"}),(0,t.jsx)(C.I,{id:"verification-code",placeholder:"000000",value:u,onChange:e=>{f(e.target.value.replace(/\D/g,"").slice(0,6)),b("")},className:"text-center text-lg tracking-widest",maxLength:6})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.z,{type:"submit",disabled:j||6!==u.length,className:"flex-1",children:j?"Verifying...":"Verify Phone Number"}),(0,t.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>Z(),disabled:w>0,children:w>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),w,"s"]}):"Resend Code"})]}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(c.z,{type:"button",variant:"ghost",onClick:()=>n("phone"),className:"text-sm",children:"Change phone number"})})]})})]}),"complete"===i&&(0,t.jsx)(l.Zb,{className:"border-green-200 bg-green-50",children:(0,t.jsxs)(l.aY,{className:"pt-6 text-center",children:[(0,t.jsx)(g.Z,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Phone Verified!"}),(0,t.jsxs)("p",{className:"text-sm text-green-600 mb-4",children:["Your phone number ",d," has been successfully verified."]})]})})]})}var Y=a(20697),$=a(34161);function I(){let{data:e,status:s,update:a}=(0,i.useSession)(),v=(0,n.useRouter)(),[w,k]=(0,r.useState)(null),[S,C]=(0,r.useState)(null),[A,E]=(0,r.useState)(!0),[V,z]=(0,r.useState)(null),[P,O]=(0,r.useState)([]),[I,U]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if("loading"!==s){if(!e){v.push("/login");return}B()}},[e,s]);let B=async()=>{try{let e=await fetch("/api/security/settings"),s=await e.json();e.ok?(k(s.security),C(s.user)):F.Am.error(s.error||"Failed to load security settings")}catch(e){console.error("Security settings error:",e),F.Am.error("Failed to load security settings")}finally{E(!1)}},L=async()=>{try{let e=await fetch("/api/auth/verify-2fa"),s=await e.json();e.ok?O(s.backupCodes):F.Am.error(s.error||"Failed to load backup codes")}catch(e){console.error("Backup codes error:",e),F.Am.error("Failed to load backup codes")}},D=()=>{z(null),B(),a()},X=async()=>{0===P.length&&await L(),z("backup-codes")};return"loading"===s||A?(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Loading security settings..."})]})}):e&&w&&S?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-900 pb-20",children:[(0,t.jsx)($.m,{title:"Security Settings"}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6",children:[(0,t.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[(0,t.jsx)(x.Z,{className:"h-5 w-5"}),"Account Security Status"]}),(0,t.jsx)(l.SZ,{className:"text-gray-400",children:"Overview of your account security features"})]}),(0,t.jsx)(l.aY,{children:(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-700/50",children:[(0,t.jsx)("div",{className:`p-2 rounded-full ${w.emailVerified?"bg-green-500/20":"bg-red-500/20"}`,children:(0,t.jsx)(u.Z,{className:`h-5 w-5 ${w.emailVerified?"text-green-400":"text-red-400"}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-200",children:"Email"}),(0,t.jsx)(d.C,{variant:w.emailVerified?"default":"destructive",className:"text-xs",children:w.emailVerified?"Verified":"Unverified"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-700/50",children:[(0,t.jsx)("div",{className:`p-2 rounded-full ${w.phoneVerified?"bg-green-500/20":"bg-red-500/20"}`,children:(0,t.jsx)(h.Z,{className:`h-5 w-5 ${w.phoneVerified?"text-green-400":"text-red-400"}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-200",children:"Phone"}),(0,t.jsx)(d.C,{variant:w.phoneVerified?"default":"destructive",className:"text-xs",children:w.phoneVerified?"Verified":"Unverified"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-700/50",children:[(0,t.jsx)("div",{className:`p-2 rounded-full ${w.twoFaEnabled?"bg-green-500/20":"bg-red-500/20"}`,children:(0,t.jsx)(f.Z,{className:`h-5 w-5 ${w.twoFaEnabled?"text-green-400":"text-red-400"}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-200",children:"2FA"}),(0,t.jsx)(d.C,{variant:w.twoFaEnabled?"default":"destructive",className:"text-xs",children:w.twoFaEnabled?"Enabled":"Disabled"})]})]})]})})]}),"complete"!==w.verificationStep&&(0,t.jsx)(Z,{securitySettings:w,onStepComplete:e=>{z(e)}}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[(0,t.jsx)(u.Z,{className:"h-5 w-5"}),"Email Verification"]}),(0,t.jsx)(l.SZ,{className:"text-gray-400",children:"Verify your email address for account security"})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-300",children:["Email: ",S.email]}),w.emailVerified?(0,t.jsx)(g.Z,{className:"h-5 w-5 text-green-400"}):(0,t.jsx)(j.Z,{className:"h-5 w-5 text-red-400"})]}),!w.emailVerified&&(0,t.jsx)(c.z,{onClick:()=>z("email"),variant:"outline",className:"w-full",children:"Verify Email"})]})]}),(0,t.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[(0,t.jsx)(h.Z,{className:"h-5 w-5"}),"Phone Verification"]}),(0,t.jsx)(l.SZ,{className:"text-gray-400",children:"Verify your phone number for SMS notifications"})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-300",children:["Phone: ",S.phone?S.phone.replace(/(\+\d{1,3})\d{6}(\d{4})/,"$1******$2"):"Not set"]}),w.phoneVerified?(0,t.jsx)(g.Z,{className:"h-5 w-5 text-green-400"}):(0,t.jsx)(j.Z,{className:"h-5 w-5 text-red-400"})]}),!w.phoneVerified&&(0,t.jsx)(c.z,{onClick:()=>z("phone"),variant:"outline",className:"w-full",children:S.phone?"Verify Phone":"Add & Verify Phone"})]})]}),(0,t.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[(0,t.jsx)(f.Z,{className:"h-5 w-5"}),"Two-Factor Authentication"]}),(0,t.jsx)(l.SZ,{className:"text-gray-400",children:"Add an extra layer of security to your account"})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-300",children:["Status: ",w.twoFaEnabled?"Enabled":"Disabled"]}),w.twoFaEnabled?(0,t.jsx)(g.Z,{className:"h-5 w-5 text-green-400"}):(0,t.jsx)(j.Z,{className:"h-5 w-5 text-red-400"})]}),w.twoFaEnabled?(0,t.jsx)("div",{className:"space-y-2",children:(0,t.jsxs)(c.z,{onClick:X,variant:"outline",size:"sm",className:"w-full",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"View Backup Codes"]})}):(0,t.jsx)(c.z,{onClick:()=>z("2fa"),variant:"outline",className:"w-full",disabled:!w.emailVerified||!w.phoneVerified,children:"Setup 2FA"})]})]}),(0,t.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[(0,t.jsx)(y.Z,{className:"h-5 w-5"}),"Account Security"]}),(0,t.jsx)(l.SZ,{className:"text-gray-400",children:"Additional security information"})]}),(0,t.jsx)(l.aY,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"text-sm space-y-2 text-gray-300",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Account Status:"}),(0,t.jsx)(d.C,{variant:S.isActive?"default":"destructive",children:S.isActive?"Active":"Inactive"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Failed Login Attempts:"}),(0,t.jsx)("span",{children:S.loginAttempts})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Account Created:"}),(0,t.jsx)("span",{children:new Date(S.createdAt).toLocaleDateString()})]})]})})]})]}),(0,t.jsxs)(o.bZ,{className:"bg-blue-950 border-blue-800",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4 text-blue-400"}),(0,t.jsxs)(o.X,{className:"text-blue-300",children:[(0,t.jsx)("strong",{children:"Security Tips:"})," Keep your authenticator app and backup codes safe. Never share your verification codes with anyone. Enable all security features for maximum protection."]})]})]}),"email"===V&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-gray-800 rounded-lg max-w-md w-full",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(Y.k,{email:S.email,onComplete:D}),(0,t.jsx)("div",{className:"mt-4 flex justify-end",children:(0,t.jsx)(c.z,{variant:"ghost",onClick:()=>z(null),children:"Close"})})]})})}),"phone"===V&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-gray-800 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(T,{phone:S.phone||"",onComplete:D,onCancel:()=>z(null)})})})}),"2fa"===V&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-gray-800 rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(R,{onComplete:D,onCancel:()=>z(null)})})})}),"backup-codes"===V&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-gray-800 rounded-lg max-w-md w-full",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-50 mb-4",children:"Backup Codes"}),P.length>0?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-700 rounded-lg",children:P.map((e,s)=>(0,t.jsx)("code",{className:"text-sm font-mono text-center p-2 bg-gray-600 rounded border",children:I?e:"••••••••"},s))}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(c.z,{onClick:()=>U(!I),variant:"outline",size:"sm",className:"flex-1",children:[I?(0,t.jsx)(b.Z,{className:"h-4 w-4 mr-2"}):(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),I?"Hide":"Show"," Codes"]}),I&&(0,t.jsxs)(c.z,{onClick:()=>{let e=new Blob([`Naggery Backup Codes

These codes can be used to access your account if you lose your phone.
Each code can only be used once.

${P.join("\n")}

Keep these codes safe and secure!`],{type:"text/plain"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="naggery-backup-codes.txt",a.click(),URL.revokeObjectURL(s),F.Am.success("Backup codes downloaded")},variant:"outline",size:"sm",className:"flex-1",children:[(0,t.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Download"]})]})]}):(0,t.jsx)("p",{className:"text-gray-400",children:"No backup codes available."}),(0,t.jsx)("div",{className:"mt-4 flex justify-end",children:(0,t.jsx)(c.z,{variant:"ghost",onClick:()=>z(null),children:"Close"})})]})})})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,t.jsxs)(o.bZ,{variant:"destructive",className:"max-w-md",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)(o.X,{children:"Failed to load security settings. Please try refreshing the page."})]})})}},34161:function(e,s,a){"use strict";a.d(s,{m:function(){return l}});var t=a(15444),r=a(98155),i=a(79047),n=a(2422);function l({title:e,showBack:s=!1,action:a}){let l=(0,i.useRouter)();return(0,t.jsx)("header",{className:"sticky top-0 z-40 bg-gray-900/95 backdrop-blur-sm border-b border-gray-800 mobile-safe-area",children:(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[s&&(0,t.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>l.back(),className:"h-10 w-10",children:(0,t.jsx)(r.Z,{className:"h-5 w-5"})}),(0,t.jsx)("h1",{className:"text-xl font-semibold text-gray-50",children:e})]}),a&&(0,t.jsx)("div",{children:a})]})})}},20697:function(e,s,a){"use strict";a.d(s,{k:function(){return u}});var t=a(15444),r=a(89300),i=a(99827),n=a(2422),l=a(56948),c=a(35798),d=a(70362),o=a(66124),m=a(81471),x=a(91585);function u({email:e,onComplete:s}){let[a,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)(""),[g,j]=(0,r.useState)(null),p=async()=>{u(!0),f("");try{let s=await fetch("/api/auth/verify-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to resend verification email");j(new Date),x.Am.success("Verification email sent successfully!")}catch(e){console.error("Resend email error:",e),f(e instanceof Error?e.message:"Failed to resend verification email")}finally{u(!1)}};return(0,t.jsxs)(i.Zb,{className:"border-yellow-200 bg-yellow-50",children:[(0,t.jsxs)(i.Ol,{children:[(0,t.jsxs)(i.ll,{className:"flex items-center gap-2 text-yellow-800",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5"}),"Email Verification Required"]}),(0,t.jsx)(i.SZ,{className:"text-yellow-700",children:"Please verify your email address to continue using your account"})]}),(0,t.jsxs)(i.aY,{className:"space-y-4",children:[h&&(0,t.jsxs)(l.bZ,{variant:"destructive",children:[(0,t.jsx)(d.Z,{className:"h-4 w-4"}),(0,t.jsx)(l.X,{children:h})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:["We sent a verification link to ",(0,t.jsx)("strong",{children:e}),". Click the link in the email to verify your account."]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-yellow-200",children:[(0,t.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Check your email for:"}),(0,t.jsxs)("ul",{className:"text-sm space-y-1 text-gray-600",children:[(0,t.jsx)("li",{children:"• A message from Naggery"}),(0,t.jsx)("li",{children:'• Subject: "Verify your Naggery account"'}),(0,t.jsx)("li",{children:'• Click the "Verify Email Address" button'})]})]}),(0,t.jsxs)(l.bZ,{children:[(0,t.jsx)(d.Z,{className:"h-4 w-4"}),(0,t.jsx)(l.X,{className:"text-sm",children:"Can't find the email? Check your spam/junk folder. The verification link expires in 24 hours."})]}),g&&(0,t.jsxs)(l.bZ,{className:"border-green-200 bg-green-50",children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 text-green-600"}),(0,t.jsxs)(l.X,{className:"text-green-700",children:["Email resent successfully at ",g.toLocaleTimeString()]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.z,{onClick:p,disabled:a,variant:"outline",className:"flex-1",children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Resend Verification Email"]})}),(0,t.jsx)(n.z,{onClick:s,variant:"ghost",children:"I'll verify later"})]})]})]})}},56948:function(e,s,a){"use strict";a.d(s,{X:function(){return d},bZ:function(){return c}});var t=a(15444),r=a(89300),i=a(2371),n=a(65522);let l=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=r.forwardRef(({className:e,variant:s,...a},r)=>(0,t.jsx)("div",{ref:r,role:"alert",className:(0,n.cn)(l({variant:s}),e),...a}));c.displayName="Alert",r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h5",{ref:a,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...s})).displayName="AlertTitle";let d=r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...s}));d.displayName="AlertDescription"},61335:function(e,s,a){"use strict";a.d(s,{C:function(){return l}});var t=a(15444);a(89300);var r=a(2371),i=a(65522);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,...a}){return(0,t.jsx)("div",{className:(0,i.cn)(n({variant:s}),e),...a})}},2422:function(e,s,a){"use strict";a.d(s,{z:function(){return d}});var t=a(15444),r=a(89300),i=a(21030),n=a(2371),l=a(65522);let c=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 touch-button",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-4 py-2",sm:"h-9 rounded-md px-3 text-xs",lg:"h-14 rounded-md px-8",icon:"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef(({className:e,variant:s,size:a,asChild:r=!1,...n},d)=>{let o=r?i.g7:"button";return(0,t.jsx)(o,{className:(0,l.cn)(c({variant:s,size:a,className:e})),ref:d,...n})});d.displayName="Button"},99827:function(e,s,a){"use strict";a.d(s,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return n},aY:function(){return o},ll:function(){return c}});var t=a(15444),r=a(89300),i=a(65522);let n=r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));n.displayName="Card";let l=r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...s}));l.displayName="CardHeader";let c=r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h3",{ref:a,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));c.displayName="CardTitle";let d=r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("p",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...s}));d.displayName="CardDescription";let o=r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,i.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",r.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},74678:function(e,s,a){"use strict";a.d(s,{I:function(){return n}});var t=a(15444),r=a(89300),i=a(65522);let n=r.forwardRef(({className:e,type:s,...a},r)=>(0,t.jsx)("input",{type:s,className:(0,i.cn)("flex h-12 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));n.displayName="Input"},34635:function(e,s,a){"use strict";a.d(s,{_:function(){return d}});var t=a(15444),r=a(89300),i=a(4100),n=a(2371),l=a(65522);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...s},a)=>(0,t.jsx)(i.f,{ref:a,className:(0,l.cn)(c(),e),...s}));d.displayName=i.f.displayName},65522:function(e,s,a){"use strict";a.d(s,{cn:function(){return i}});var t=a(32191),r=a(23607);function i(...e){return(0,r.m6)((0,t.W)(e))}}},function(e){e.O(0,[162,762,477,754,386,156,744],function(){return e(e.s=21481)}),_N_E=e.O()}]);