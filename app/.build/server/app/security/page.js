(()=>{var e={};e.id=127,e.ids=[127],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},77450:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>o}),s(8125),s(32694),s(71363);var a=s(36576),r=s(72007),i=s(21818),n=s.n(i),l=s(88897),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["security",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8125)),"/home/ubuntu/naggery_app/app/app/security/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,32694)),"/home/ubuntu/naggery_app/app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,71363,23)),"next/dist/client/components/not-found-error"]}],d=["/home/ubuntu/naggery_app/app/app/security/page.tsx"],u="/security/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/security/page",pathname:"/security",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},62243:(e,t,s)=>{Promise.resolve().then(s.bind(s,59006))},59006:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>et});var a=s(62901),r=s(24383),i=s(84700),n=s(84374),l=s(23803),c=s(27878),o=s(31606),d=s(80568),u=s(21680),m=s(44928),h=s(19918),x=s(32614),f=s(71945);let p=(0,f.Z)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var g=s(23094);let y=(0,f.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),j=(0,f.Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var v=s(67935);let b=(0,f.Z)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var N=s(68734),w=s(89291),S=s(74132),k="Progress",[C,P]=(0,w.b)(k),[Z,_]=C(k),E=r.forwardRef((e,t)=>{var s,r;let{__scopeProgress:i,value:n=null,max:l,getValueLabel:c=M,...o}=e;(l||0===l)&&!R(l)&&console.error((s=`${l}`,`Invalid prop \`max\` of value \`${s}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let d=R(l)?l:100;null===n||F(n,d)||console.error((r=`${n}`,`Invalid prop \`value\` of value \`${r}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let u=F(n,d)?n:null,m=O(u)?c(u,d):void 0;return(0,a.jsx)(Z,{scope:i,value:u,max:d,children:(0,a.jsx)(S.WV.div,{"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":O(u)?u:void 0,"aria-valuetext":m,role:"progressbar","data-state":V(u,d),"data-value":u??void 0,"data-max":d,...o,ref:t})})});E.displayName=k;var A="ProgressIndicator",z=r.forwardRef((e,t)=>{let{__scopeProgress:s,...r}=e,i=_(A,s);return(0,a.jsx)(S.WV.div,{"data-state":V(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:t})});function M(e,t){return`${Math.round(e/t*100)}%`}function V(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function O(e){return"number"==typeof e}function R(e){return O(e)&&!isNaN(e)&&e>0}function F(e,t){return O(e)&&!isNaN(e)&&e<=t&&e>=0}z.displayName=A;var I=s(68637);let T=r.forwardRef(({className:e,value:t,...s},r)=>a.jsx(E,{ref:r,className:(0,I.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:a.jsx(z,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));T.displayName=E.displayName;let D=(0,f.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function $({securitySettings:e,onStepComplete:t,className:s=""}){let{data:n}=(0,i.useSession)(),[d,u]=(0,r.useState)(0),f=[{step:1,title:"Email Verification",description:"Verify your email address to secure your account",completed:e.emailVerified,required:!0},{step:2,title:"Phone Verification",description:"Add and verify your phone number for SMS notifications",completed:e.phoneVerified,required:!0},{step:3,title:"Two-Factor Authentication",description:"Enable 2FA for enhanced security using an authenticator app",completed:e.twoFaEnabled,required:!0}],p=(e,t)=>{if(e.completed)return a.jsx(g.Z,{className:"h-6 w-6 text-green-500"});if(t===d)return a.jsx(D,{className:"h-6 w-6 text-yellow-500"});switch(e.step){case 1:return a.jsx(h.Z,{className:"h-6 w-6 text-gray-400"});case 2:return a.jsx(x.Z,{className:"h-6 w-6 text-gray-400"});case 3:return a.jsx(m.Z,{className:"h-6 w-6 text-gray-400"});default:return a.jsx(D,{className:"h-6 w-6 text-gray-400"})}},y=(e,t)=>e.completed?a.jsx(o.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Completed"}):t===d?a.jsx(o.C,{variant:"default",className:"bg-yellow-100 text-yellow-800",children:"In Progress"}):a.jsx(o.C,{variant:"secondary",children:"Pending"}),j=f.filter(e=>e.completed).length,v=j/f.length*100,b=e=>{t(e)};return"complete"===e.verificationStep?a.jsx(l.Zb,{className:`border-green-200 bg-green-50 ${s}`,children:(0,a.jsxs)(l.aY,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(g.Z,{className:"h-8 w-8 text-green-500"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Security Setup Complete!"}),a.jsx("p",{className:"text-sm text-green-600",children:"Your account is fully secured with all verification methods enabled."})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(g.Z,{className:"h-4 w-4 text-green-500"}),a.jsx("span",{children:"Email Verified"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(g.Z,{className:"h-4 w-4 text-green-500"}),a.jsx("span",{children:"Phone Verified"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(g.Z,{className:"h-4 w-4 text-green-500"}),a.jsx("span",{children:"2FA Enabled"})]})]})]})}):(0,a.jsxs)(l.Zb,{className:s,children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(m.Z,{className:"h-5 w-5"}),"Security Setup"]}),a.jsx(l.SZ,{children:"Complete these steps to secure your account"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Progress"}),(0,a.jsxs)("span",{children:[j," of ",f.length," completed"]})]}),a.jsx(T,{value:v,className:"h-2"})]})]}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[f.map((e,t)=>(0,a.jsxs)("div",{className:`flex items-center gap-4 p-4 rounded-lg border transition-colors ${t===d?"border-blue-200 bg-blue-50":e.completed?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:[a.jsx("div",{className:"flex-shrink-0",children:p(e,t)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h4",{className:"font-medium text-sm",children:e.title}),y(e,t)]}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),!e.completed&&t===d&&a.jsx(c.z,{size:"sm",onClick:()=>{switch(e.step){case 1:b("email");break;case 2:b("phone");break;case 3:b("2fa")}},className:"flex-shrink-0",children:1===e.step?"Verify Email":2===e.step?"Verify Phone":"Setup 2FA"})]},e.step)),d>=f.length&&(0,a.jsxs)("div",{className:"text-center py-4",children:[a.jsx(g.Z,{className:"h-12 w-12 text-green-500 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"All Set!"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Your account security is fully configured. You can access all features now."})]})]})]})}var L=s(250),q=s(74128);let U=(0,f.Z)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),Y=(0,f.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var B=s(43921),X=s(24169),G=s.n(X);function W({onComplete:e,onCancel:t}){let[s,i]=(0,r.useState)("generate"),[n,h]=(0,r.useState)(""),[x,f]=(0,r.useState)(""),[p,y]=(0,r.useState)([]),[j,v]=(0,r.useState)(""),[b,w]=(0,r.useState)(!1),[S,k]=(0,r.useState)(""),C=async()=>{if(!j||6!==j.length){k("Please enter a valid 6-digit code");return}w(!0),k("");try{let e=await fetch("/api/auth/setup-2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:j})}),t=await e.json();if(!e.ok)throw Error(t.error||"Invalid verification code");i("backup"),B.Am.success("2FA enabled successfully!")}catch(e){console.error("2FA verification error:",e),k(e instanceof Error?e.message:"Verification failed")}finally{w(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,a.jsxs)("div",{className:`flex items-center ${"generate"===s||"verify"===s?"text-blue-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${"generate"===s||"verify"===s?"border-blue-600 bg-blue-50":"border-gray-300"}`,children:"generate"!==s&&"verify"!==s?a.jsx(g.Z,{className:"w-5 h-5 text-green-600"}):a.jsx("span",{className:"text-sm font-medium",children:"1"})}),a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Setup"})]}),a.jsx("div",{className:`w-8 h-0.5 ${"backup"===s||"complete"===s?"bg-blue-600":"bg-gray-300"}`}),(0,a.jsxs)("div",{className:`flex items-center ${"backup"===s?"text-blue-600":"complete"===s?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${"backup"===s?"border-blue-600 bg-blue-50":"complete"===s?"border-green-600 bg-green-50":"border-gray-300"}`,children:"complete"===s?a.jsx(g.Z,{className:"w-5 h-5 text-green-600"}):a.jsx("span",{className:"text-sm font-medium",children:"2"})}),a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Backup Codes"})]})]}),("generate"===s||"verify"===s)&&(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(U,{className:"h-5 w-5"}),"generate"===s?"Setting up 2FA...":"Scan QR Code"]}),a.jsx(l.SZ,{children:"generate"===s?"Please wait while we generate your 2FA setup...":"Use your authenticator app to scan the QR code below"})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[S&&(0,a.jsxs)(d.bZ,{variant:"destructive",children:[a.jsx(u.Z,{className:"h-4 w-4"}),a.jsx(d.X,{children:S})]}),"verify"===s&&n&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:a.jsx(G(),{src:n,alt:"2FA QR Code",width:200,height:200,className:"rounded"})})}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(q._,{className:"text-sm font-medium",children:"Can't scan? Enter this code manually:"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("code",{className:"flex-1 p-2 bg-gray-100 rounded text-sm font-mono break-all",children:x}),a.jsx(c.z,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(x),B.Am.success("Secret copied to clipboard")},children:a.jsx(Y,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)(d.bZ,{children:[a.jsx(m.Z,{className:"h-4 w-4"}),(0,a.jsxs)(d.X,{className:"text-sm",children:[a.jsx("strong",{children:"Recommended apps:"})," Google Authenticator, Authy, Microsoft Authenticator, or 1Password. After scanning, enter the 6-digit code from your app below."]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx(q._,{htmlFor:"verification-code",children:"Enter verification code from your app"}),a.jsx(L.I,{id:"verification-code",placeholder:"000000",value:j,onChange:e=>{v(e.target.value.replace(/\D/g,"").slice(0,6)),k("")},className:"text-center text-lg tracking-widest",maxLength:6}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(c.z,{onClick:C,disabled:b||6!==j.length,className:"flex-1",children:b?"Verifying...":"Verify & Enable 2FA"}),a.jsx(c.z,{variant:"outline",onClick:t,children:"Cancel"})]})]})]})]})]}),"backup"===s&&(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(N.Z,{className:"h-5 w-5"}),"Save Your Backup Codes"]}),a.jsx(l.SZ,{children:"These codes can be used to access your account if you lose your authenticator device. Each code can only be used once."})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[(0,a.jsxs)(d.bZ,{children:[a.jsx(u.Z,{className:"h-4 w-4"}),(0,a.jsxs)(d.X,{children:[a.jsx("strong",{children:"Important:"})," Store these codes in a safe place. You won't be able to see them again."]})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-50 rounded-lg",children:p.map((e,t)=>a.jsx("code",{className:"text-sm font-mono text-center p-2 bg-white rounded border",children:e},t))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{onClick:()=>{let e=new Blob([`Naggery Backup Codes

These codes can be used to access your account if you lose your phone.
Each code can only be used once.

${p.join("\n")}

Keep these codes safe and secure!`],{type:"text/plain"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="naggery-backup-codes.txt",s.click(),URL.revokeObjectURL(t),B.Am.success("Backup codes downloaded")},variant:"outline",className:"flex-1",children:[a.jsx(N.Z,{className:"h-4 w-4 mr-2"}),"Download Codes"]}),(0,a.jsxs)(c.z,{onClick:()=>{navigator.clipboard.writeText(p.join(", ")),B.Am.success("Backup codes copied to clipboard")},variant:"outline",className:"flex-1",children:[a.jsx(Y,{className:"h-4 w-4 mr-2"}),"Copy Codes"]})]}),a.jsx(c.z,{onClick:()=>{i("complete"),setTimeout(()=>{e?.()},2e3)},className:"w-full",children:"I've Saved My Backup Codes"})]})]}),"complete"===s&&a.jsx(l.Zb,{className:"border-green-200 bg-green-50",children:(0,a.jsxs)(l.aY,{className:"pt-6 text-center",children:[a.jsx(g.Z,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"2FA Setup Complete!"}),a.jsx("p",{className:"text-sm text-green-600 mb-4",children:"Your account is now protected with two-factor authentication."}),a.jsx(o.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Security Enhanced"})]})})]})}let H=(0,f.Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var J=s(21391);function K({phone:e,onComplete:t,onCancel:s}){let[i,n]=(0,r.useState)("phone"),[o,m]=(0,r.useState)(e||""),[h,f]=(0,r.useState)(""),[p,y]=(0,r.useState)(!1),[j,v]=(0,r.useState)(""),[b,N]=(0,r.useState)(""),[w,S]=(0,r.useState)(0),k=e=>{let t=e.replace(/[^\d+]/g,"");return t.startsWith("+")?t:t?`+1${t}`:""},C=async(e=o)=>{if(!e){v("Phone number is required");return}let t=k(e);if(!/^\+[1-9]\d{1,14}$/.test(t)){v("Invalid phone number format. Please include country code (e.g., +1234567890)");return}y(!0),v("");try{let e=await fetch("/api/auth/verify-sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:t})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to send verification code");m(t),n("verify"),S(60);let a=setInterval(()=>{S(e=>e<=1?(clearInterval(a),0):e-1)},1e3);B.Am.success(`Verification code sent to ${s.maskedPhone}`)}catch(e){console.error("SMS sending error:",e),v(e instanceof Error?e.message:"Failed to send verification code")}finally{y(!1)}},P=async()=>{if(!h||6!==h.length){v("Please enter a valid 6-digit code");return}y(!0),v("");try{let e=await fetch("/api/auth/verify-sms",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:b,code:h})}),s=await e.json();if(!e.ok)throw Error(s.error||"Invalid verification code");n("complete"),B.Am.success("Phone number verified successfully!"),setTimeout(()=>{t?.()},2e3)}catch(e){console.error("SMS verification error:",e),v(e instanceof Error?e.message:"Verification failed")}finally{y(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:["phone"===i&&(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(x.Z,{className:"h-5 w-5"}),"Phone Verification"]}),a.jsx(l.SZ,{children:"Enter your phone number to receive a verification code via SMS"})]}),a.jsx(l.aY,{children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),C()},className:"space-y-4",children:[j&&(0,a.jsxs)(d.bZ,{variant:"destructive",children:[a.jsx(u.Z,{className:"h-4 w-4"}),a.jsx(d.X,{children:j})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(q._,{htmlFor:"phone",children:"Phone Number"}),a.jsx(L.I,{id:"phone",type:"tel",placeholder:"+1234567890",value:o,onChange:e=>{m(k(e.target.value)),v("")},className:"text-lg"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Include country code (e.g., +1 for US, +44 for UK)"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(c.z,{type:"submit",disabled:p||!o,className:"flex-1",children:p?"Sending...":"Send Verification Code"}),a.jsx(c.z,{type:"button",variant:"outline",onClick:s,children:"Cancel"})]})]})})]}),"verify"===i&&(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(H,{className:"h-5 w-5"}),"Enter Verification Code"]}),(0,a.jsxs)(l.SZ,{children:["We sent a 6-digit code to ",o,". Enter it below to verify your phone number."]})]}),a.jsx(l.aY,{children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),P()},className:"space-y-4",children:[j&&(0,a.jsxs)(d.bZ,{variant:"destructive",children:[a.jsx(u.Z,{className:"h-4 w-4"}),a.jsx(d.X,{children:j})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(q._,{htmlFor:"verification-code",children:"Verification Code"}),a.jsx(L.I,{id:"verification-code",placeholder:"000000",value:h,onChange:e=>{f(e.target.value.replace(/\D/g,"").slice(0,6)),v("")},className:"text-center text-lg tracking-widest",maxLength:6})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(c.z,{type:"submit",disabled:p||6!==h.length,className:"flex-1",children:p?"Verifying...":"Verify Phone Number"}),a.jsx(c.z,{type:"button",variant:"outline",onClick:()=>C(),disabled:w>0,children:w>0?(0,a.jsxs)(a.Fragment,{children:[a.jsx(J.Z,{className:"h-4 w-4 mr-2"}),w,"s"]}):"Resend Code"})]}),a.jsx("div",{className:"text-center",children:a.jsx(c.z,{type:"button",variant:"ghost",onClick:()=>n("phone"),className:"text-sm",children:"Change phone number"})})]})})]}),"complete"===i&&a.jsx(l.Zb,{className:"border-green-200 bg-green-50",children:(0,a.jsxs)(l.aY,{className:"pt-6 text-center",children:[a.jsx(g.Z,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Phone Verified!"}),(0,a.jsxs)("p",{className:"text-sm text-green-600 mb-4",children:["Your phone number ",o," has been successfully verified."]})]})})]})}var Q=s(39249),ee=s(24022);function et(){let{data:e,status:t,update:s}=(0,i.useSession)();(0,n.useRouter)();let[f,w]=(0,r.useState)(null),[S,k]=(0,r.useState)(null),[C,P]=(0,r.useState)(!0),[Z,_]=(0,r.useState)(null),[E,A]=(0,r.useState)([]),[z,M]=(0,r.useState)(!1),V=async()=>{try{let e=await fetch("/api/security/settings"),t=await e.json();e.ok?(w(t.security),k(t.user)):B.Am.error(t.error||"Failed to load security settings")}catch(e){console.error("Security settings error:",e),B.Am.error("Failed to load security settings")}finally{P(!1)}},O=async()=>{try{let e=await fetch("/api/auth/verify-2fa"),t=await e.json();e.ok?A(t.backupCodes):B.Am.error(t.error||"Failed to load backup codes")}catch(e){console.error("Backup codes error:",e),B.Am.error("Failed to load backup codes")}},R=()=>{_(null),V(),s()},F=async()=>{0===E.length&&await O(),_("backup-codes")};return"loading"===t||C?a.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400",children:"Loading security settings..."})]})}):e&&f&&S?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-900 pb-20",children:[a.jsx(ee.m,{title:"Security Settings"}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6",children:[(0,a.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[a.jsx(m.Z,{className:"h-5 w-5"}),"Account Security Status"]}),a.jsx(l.SZ,{className:"text-gray-400",children:"Overview of your account security features"})]}),a.jsx(l.aY,{children:(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-700/50",children:[a.jsx("div",{className:`p-2 rounded-full ${f.emailVerified?"bg-green-500/20":"bg-red-500/20"}`,children:a.jsx(h.Z,{className:`h-5 w-5 ${f.emailVerified?"text-green-400":"text-red-400"}`})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-gray-200",children:"Email"}),a.jsx(o.C,{variant:f.emailVerified?"default":"destructive",className:"text-xs",children:f.emailVerified?"Verified":"Unverified"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-700/50",children:[a.jsx("div",{className:`p-2 rounded-full ${f.phoneVerified?"bg-green-500/20":"bg-red-500/20"}`,children:a.jsx(x.Z,{className:`h-5 w-5 ${f.phoneVerified?"text-green-400":"text-red-400"}`})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-gray-200",children:"Phone"}),a.jsx(o.C,{variant:f.phoneVerified?"default":"destructive",className:"text-xs",children:f.phoneVerified?"Verified":"Unverified"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-700/50",children:[a.jsx("div",{className:`p-2 rounded-full ${f.twoFaEnabled?"bg-green-500/20":"bg-red-500/20"}`,children:a.jsx(p,{className:`h-5 w-5 ${f.twoFaEnabled?"text-green-400":"text-red-400"}`})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-gray-200",children:"2FA"}),a.jsx(o.C,{variant:f.twoFaEnabled?"default":"destructive",className:"text-xs",children:f.twoFaEnabled?"Enabled":"Disabled"})]})]})]})})]}),"complete"!==f.verificationStep&&a.jsx($,{securitySettings:f,onStepComplete:e=>{_(e)}}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[a.jsx(h.Z,{className:"h-5 w-5"}),"Email Verification"]}),a.jsx(l.SZ,{className:"text-gray-400",children:"Verify your email address for account security"})]}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["Email: ",S.email]}),f.emailVerified?a.jsx(g.Z,{className:"h-5 w-5 text-green-400"}):a.jsx(y,{className:"h-5 w-5 text-red-400"})]}),!f.emailVerified&&a.jsx(c.z,{onClick:()=>_("email"),variant:"outline",className:"w-full",children:"Verify Email"})]})]}),(0,a.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[a.jsx(x.Z,{className:"h-5 w-5"}),"Phone Verification"]}),a.jsx(l.SZ,{className:"text-gray-400",children:"Verify your phone number for SMS notifications"})]}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["Phone: ",S.phone?S.phone.replace(/(\+\d{1,3})\d{6}(\d{4})/,"$1******$2"):"Not set"]}),f.phoneVerified?a.jsx(g.Z,{className:"h-5 w-5 text-green-400"}):a.jsx(y,{className:"h-5 w-5 text-red-400"})]}),!f.phoneVerified&&a.jsx(c.z,{onClick:()=>_("phone"),variant:"outline",className:"w-full",children:S.phone?"Verify Phone":"Add & Verify Phone"})]})]}),(0,a.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[a.jsx(p,{className:"h-5 w-5"}),"Two-Factor Authentication"]}),a.jsx(l.SZ,{className:"text-gray-400",children:"Add an extra layer of security to your account"})]}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["Status: ",f.twoFaEnabled?"Enabled":"Disabled"]}),f.twoFaEnabled?a.jsx(g.Z,{className:"h-5 w-5 text-green-400"}):a.jsx(y,{className:"h-5 w-5 text-red-400"})]}),f.twoFaEnabled?a.jsx("div",{className:"space-y-2",children:(0,a.jsxs)(c.z,{onClick:F,variant:"outline",size:"sm",className:"w-full",children:[a.jsx(j,{className:"h-4 w-4 mr-2"}),"View Backup Codes"]})}):a.jsx(c.z,{onClick:()=>_("2fa"),variant:"outline",className:"w-full",disabled:!f.emailVerified||!f.phoneVerified,children:"Setup 2FA"})]})]}),(0,a.jsxs)(l.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center gap-2 text-gray-50",children:[a.jsx(v.Z,{className:"h-5 w-5"}),"Account Security"]}),a.jsx(l.SZ,{className:"text-gray-400",children:"Additional security information"})]}),a.jsx(l.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"text-sm space-y-2 text-gray-300",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Account Status:"}),a.jsx(o.C,{variant:S.isActive?"default":"destructive",children:S.isActive?"Active":"Inactive"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Failed Login Attempts:"}),a.jsx("span",{children:S.loginAttempts})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Account Created:"}),a.jsx("span",{children:new Date(S.createdAt).toLocaleDateString()})]})]})})]})]}),(0,a.jsxs)(d.bZ,{className:"bg-blue-950 border-blue-800",children:[a.jsx(m.Z,{className:"h-4 w-4 text-blue-400"}),(0,a.jsxs)(d.X,{className:"text-blue-300",children:[a.jsx("strong",{children:"Security Tips:"})," Keep your authenticator app and backup codes safe. Never share your verification codes with anyone. Enable all security features for maximum protection."]})]})]}),"email"===Z&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-gray-800 rounded-lg max-w-md w-full",children:(0,a.jsxs)("div",{className:"p-6",children:[a.jsx(Q.k,{email:S.email,onComplete:R}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx(c.z,{variant:"ghost",onClick:()=>_(null),children:"Close"})})]})})}),"phone"===Z&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-gray-800 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsx("div",{className:"p-6",children:a.jsx(K,{phone:S.phone||"",onComplete:R,onCancel:()=>_(null)})})})}),"2fa"===Z&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-gray-800 rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:a.jsx("div",{className:"p-6",children:a.jsx(W,{onComplete:R,onCancel:()=>_(null)})})})}),"backup-codes"===Z&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-gray-800 rounded-lg max-w-md w-full",children:(0,a.jsxs)("div",{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-50 mb-4",children:"Backup Codes"}),E.length>0?(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-700 rounded-lg",children:E.map((e,t)=>a.jsx("code",{className:"text-sm font-mono text-center p-2 bg-gray-600 rounded border",children:z?e:"••••••••"},t))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{onClick:()=>M(!z),variant:"outline",size:"sm",className:"flex-1",children:[z?a.jsx(b,{className:"h-4 w-4 mr-2"}):a.jsx(j,{className:"h-4 w-4 mr-2"}),z?"Hide":"Show"," Codes"]}),z&&(0,a.jsxs)(c.z,{onClick:()=>{let e=new Blob([`Naggery Backup Codes

These codes can be used to access your account if you lose your phone.
Each code can only be used once.

${E.join("\n")}

Keep these codes safe and secure!`],{type:"text/plain"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="naggery-backup-codes.txt",s.click(),URL.revokeObjectURL(t),B.Am.success("Backup codes downloaded")},variant:"outline",size:"sm",className:"flex-1",children:[a.jsx(N.Z,{className:"h-4 w-4 mr-2"}),"Download"]})]})]}):a.jsx("p",{className:"text-gray-400",children:"No backup codes available."}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx(c.z,{variant:"ghost",onClick:()=>_(null),children:"Close"})})]})})})]}):a.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,a.jsxs)(d.bZ,{variant:"destructive",className:"max-w-md",children:[a.jsx(u.Z,{className:"h-4 w-4"}),a.jsx(d.X,{children:"Failed to load security settings. Please try refreshing the page."})]})})}},39249:(e,t,s)=>{"use strict";s.d(t,{k:()=>h});var a=s(62901),r=s(24383),i=s(23803),n=s(27878),l=s(80568),c=s(19918),o=s(21680),d=s(23094),u=s(10780),m=s(43921);function h({email:e,onComplete:t}){let[s,h]=(0,r.useState)(!1),[x,f]=(0,r.useState)(""),[p,g]=(0,r.useState)(null),y=async()=>{h(!0),f("");try{let t=await fetch("/api/auth/verify-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to resend verification email");g(new Date),m.Am.success("Verification email sent successfully!")}catch(e){console.error("Resend email error:",e),f(e instanceof Error?e.message:"Failed to resend verification email")}finally{h(!1)}};return(0,a.jsxs)(i.Zb,{className:"border-yellow-200 bg-yellow-50",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)(i.ll,{className:"flex items-center gap-2 text-yellow-800",children:[a.jsx(c.Z,{className:"h-5 w-5"}),"Email Verification Required"]}),a.jsx(i.SZ,{className:"text-yellow-700",children:"Please verify your email address to continue using your account"})]}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[x&&(0,a.jsxs)(l.bZ,{variant:"destructive",children:[a.jsx(o.Z,{className:"h-4 w-4"}),a.jsx(l.X,{children:x})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["We sent a verification link to ",a.jsx("strong",{children:e}),". Click the link in the email to verify your account."]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-yellow-200",children:[a.jsx("h4",{className:"font-medium text-sm mb-2",children:"Check your email for:"}),(0,a.jsxs)("ul",{className:"text-sm space-y-1 text-gray-600",children:[a.jsx("li",{children:"• A message from Naggery"}),a.jsx("li",{children:'• Subject: "Verify your Naggery account"'}),a.jsx("li",{children:'• Click the "Verify Email Address" button'})]})]}),(0,a.jsxs)(l.bZ,{children:[a.jsx(o.Z,{className:"h-4 w-4"}),a.jsx(l.X,{className:"text-sm",children:"Can't find the email? Check your spam/junk folder. The verification link expires in 24 hours."})]}),p&&(0,a.jsxs)(l.bZ,{className:"border-green-200 bg-green-50",children:[a.jsx(d.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)(l.X,{className:"text-green-700",children:["Email resent successfully at ",p.toLocaleTimeString()]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(n.z,{onClick:y,disabled:s,variant:"outline",className:"flex-1",children:s?(0,a.jsxs)(a.Fragment,{children:[a.jsx(u.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Resend Verification Email"]})}),a.jsx(n.z,{onClick:t,variant:"ghost",children:"I'll verify later"})]})]})]})}},80568:(e,t,s)=>{"use strict";s.d(t,{X:()=>o,bZ:()=>c});var a=s(62901),r=s(24383),i=s(47279),n=s(68637);let l=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=r.forwardRef(({className:e,variant:t,...s},r)=>a.jsx("div",{ref:r,role:"alert",className:(0,n.cn)(l({variant:t}),e),...s}));c.displayName="Alert",r.forwardRef(({className:e,...t},s)=>a.jsx("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";let o=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...t}));o.displayName="AlertDescription"},31606:(e,t,s)=>{"use strict";s.d(t,{C:()=>l});var a=s(62901);s(24383);var r=s(47279),i=s(68637);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...s}){return a.jsx("div",{className:(0,i.cn)(n({variant:t}),e),...s})}},250:(e,t,s)=>{"use strict";s.d(t,{I:()=>n});var a=s(62901),r=s(24383),i=s(68637);let n=r.forwardRef(({className:e,type:t,...s},r)=>a.jsx("input",{type:t,className:(0,i.cn)("flex h-12 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s}));n.displayName="Input"},74128:(e,t,s)=>{"use strict";s.d(t,{_:()=>d});var a=s(62901),r=s(24383),i=s(74132),n=r.forwardRef((e,t)=>(0,a.jsx)(i.WV.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var l=s(47279),c=s(68637);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...t},s)=>a.jsx(n,{ref:s,className:(0,c.cn)(o(),e),...t}));d.displayName=n.displayName},75909:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(71945).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},21391:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(71945).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},68734:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(71945).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},44928:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(71945).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},84374:(e,t,s)=>{"use strict";var a=s(75229);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},42371:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return j}});let a=s(87946),r=s(90692),i=s(62901),n=r._(s(24383)),l=a._(s(8361)),c=a._(s(12538)),o=s(55653),d=s(40440),u=s(18251);s(59882);let m=s(99293),h=a._(s(83198)),x={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0};function f(e,t,s,a,r,i,n){let l=null==e?void 0:e.src;e&&e["data-loaded-src"]!==l&&(e["data-loaded-src"]=l,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&r(!0),null==s?void 0:s.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let a=!1,r=!1;s.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>a,isPropagationStopped:()=>r,persist:()=>{},preventDefault:()=>{a=!0,t.preventDefault()},stopPropagation:()=>{r=!0,t.stopPropagation()}})}(null==a?void 0:a.current)&&a.current(e)}}))}function p(e){return n.use?{fetchPriority:e}:{fetchpriority:e}}globalThis.__NEXT_IMAGE_IMPORTED=!0;let g=(0,n.forwardRef)((e,t)=>{let{src:s,srcSet:a,sizes:r,height:l,width:c,decoding:o,className:d,style:u,fetchPriority:m,placeholder:h,loading:x,unoptimized:g,fill:y,onLoadRef:j,onLoadingCompleteRef:v,setBlurComplete:b,setShowAltText:N,sizesInput:w,onLoad:S,onError:k,...C}=e;return(0,i.jsx)("img",{...C,...p(m),loading:x,width:c,height:l,decoding:o,"data-nimg":y?"fill":"1",className:d,style:u,sizes:r,srcSet:a,src:s,ref:(0,n.useCallback)(e=>{t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e&&(k&&(e.src=e.src),e.complete&&f(e,h,j,v,b,g,w))},[s,h,j,v,b,k,g,w,t]),onLoad:e=>{f(e.currentTarget,h,j,v,b,g,w)},onError:e=>{N(!0),"empty"!==h&&b(!0),k&&k(e)}})});function y(e){let{isAppRouter:t,imgAttributes:s}=e,a={as:"image",imageSrcSet:s.srcSet,imageSizes:s.sizes,crossOrigin:s.crossOrigin,referrerPolicy:s.referrerPolicy,...p(s.fetchPriority)};return t&&l.default.preload?(l.default.preload(s.src,a),null):(0,i.jsx)(c.default,{children:(0,i.jsx)("link",{rel:"preload",href:s.srcSet?void 0:s.src,...a},"__nimg-"+s.src+s.srcSet+s.sizes)})}let j=(0,n.forwardRef)((e,t)=>{let s=(0,n.useContext)(m.RouterContext),a=(0,n.useContext)(u.ImageConfigContext),r=(0,n.useMemo)(()=>{var e;let t=x||a||d.imageConfigDefault,s=[...t.deviceSizes,...t.imageSizes].sort((e,t)=>e-t),r=t.deviceSizes.sort((e,t)=>e-t),i=null==(e=t.qualities)?void 0:e.sort((e,t)=>e-t);return{...t,allSizes:s,deviceSizes:r,qualities:i}},[a]),{onLoad:l,onLoadingComplete:c}=e,f=(0,n.useRef)(l);(0,n.useEffect)(()=>{f.current=l},[l]);let p=(0,n.useRef)(c);(0,n.useEffect)(()=>{p.current=c},[c]);let[j,v]=(0,n.useState)(!1),[b,N]=(0,n.useState)(!1),{props:w,meta:S}=(0,o.getImgProps)(e,{defaultLoader:h.default,imgConf:r,blurComplete:j,showAltText:b});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g,{...w,unoptimized:S.unoptimized,placeholder:S.placeholder,fill:S.fill,onLoadRef:f,onLoadingCompleteRef:p,setBlurComplete:v,setShowAltText:N,sizesInput:e.sizes,ref:t}),S.priority?(0,i.jsx)(y,{isAppRouter:!s,imgAttributes:w}):null]})});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4490:(e,t,s)=>{"use strict";e.exports=s(66179).vendored.contexts.AmpContext},24021:(e,t,s)=>{"use strict";e.exports=s(66179).vendored.contexts.HeadManagerContext},18251:(e,t,s)=>{"use strict";e.exports=s(66179).vendored.contexts.ImageConfigContext},99293:(e,t,s)=>{"use strict";e.exports=s(66179).vendored.contexts.RouterContext},23149:(e,t)=>{"use strict";function s(e){let{ampFirst:t=!1,hybrid:s=!1,hasQuery:a=!1}=void 0===e?{}:e;return t||s&&a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return s}})},55653:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImgProps",{enumerable:!0,get:function(){return l}}),s(59882);let a=s(55335),r=s(40440);function i(e){return void 0!==e.default}function n(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function l(e,t){var s,l;let c,o,d,{src:u,sizes:m,unoptimized:h=!1,priority:x=!1,loading:f,className:p,quality:g,width:y,height:j,fill:v=!1,style:b,overrideSrc:N,onLoad:w,onLoadingComplete:S,placeholder:k="empty",blurDataURL:C,fetchPriority:P,decoding:Z="async",layout:_,objectFit:E,objectPosition:A,lazyBoundary:z,lazyRoot:M,...V}=e,{imgConf:O,showAltText:R,blurComplete:F,defaultLoader:I}=t,T=O||r.imageConfigDefault;if("allSizes"in T)c=T;else{let e=[...T.deviceSizes,...T.imageSizes].sort((e,t)=>e-t),t=T.deviceSizes.sort((e,t)=>e-t),a=null==(s=T.qualities)?void 0:s.sort((e,t)=>e-t);c={...T,allSizes:e,deviceSizes:t,qualities:a}}if(void 0===I)throw Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config");let D=V.loader||I;delete V.loader,delete V.srcSet;let $="__next_img_default"in D;if($){if("custom"===c.loader)throw Error('Image with src "'+u+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let e=D;D=t=>{let{config:s,...a}=t;return e(a)}}if(_){"fill"===_&&(v=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[_];e&&(b={...b,...e});let t={responsive:"100vw",fill:"100vw"}[_];t&&!m&&(m=t)}let L="",q=n(y),U=n(j);if("object"==typeof(l=u)&&(i(l)||void 0!==l.src)){let e=i(u)?u.default:u;if(!e.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e));if(!e.height||!e.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e));if(o=e.blurWidth,d=e.blurHeight,C=C||e.blurDataURL,L=e.src,!v){if(q||U){if(q&&!U){let t=q/e.width;U=Math.round(e.height*t)}else if(!q&&U){let t=U/e.height;q=Math.round(e.width*t)}}else q=e.width,U=e.height}}let Y=!x&&("lazy"===f||void 0===f);(!(u="string"==typeof u?u:L)||u.startsWith("data:")||u.startsWith("blob:"))&&(h=!0,Y=!1),c.unoptimized&&(h=!0),$&&u.endsWith(".svg")&&!c.dangerouslyAllowSVG&&(h=!0),x&&(P="high");let B=n(g),X=Object.assign(v?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:E,objectPosition:A}:{},R?{}:{color:"transparent"},b),G=F||"empty"===k?null:"blur"===k?'url("data:image/svg+xml;charset=utf-8,'+(0,a.getImageBlurSvg)({widthInt:q,heightInt:U,blurWidth:o,blurHeight:d,blurDataURL:C||"",objectFit:X.objectFit})+'")':'url("'+k+'")',W=G?{backgroundSize:X.objectFit||"cover",backgroundPosition:X.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:G}:{},H=function(e){let{config:t,src:s,unoptimized:a,width:r,quality:i,sizes:n,loader:l}=e;if(a)return{src:s,srcSet:void 0,sizes:void 0};let{widths:c,kind:o}=function(e,t,s){let{deviceSizes:a,allSizes:r}=e;if(s){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let a;a=e.exec(s);a)t.push(parseInt(a[2]));if(t.length){let e=.01*Math.min(...t);return{widths:r.filter(t=>t>=a[0]*e),kind:"w"}}return{widths:r,kind:"w"}}return"number"!=typeof t?{widths:a,kind:"w"}:{widths:[...new Set([t,2*t].map(e=>r.find(t=>t>=e)||r[r.length-1]))],kind:"x"}}(t,r,n),d=c.length-1;return{sizes:n||"w"!==o?n:"100vw",srcSet:c.map((e,a)=>l({config:t,src:s,quality:i,width:e})+" "+("w"===o?e:a+1)+o).join(", "),src:l({config:t,src:s,quality:i,width:c[d]})}}({config:c,src:u,unoptimized:h,width:q,quality:B,sizes:m,loader:D});return{props:{...V,loading:Y?"lazy":f,fetchPriority:P,width:q,height:U,decoding:Z,className:p,style:{...X,...W},sizes:H.sizes,srcSet:H.srcSet,src:N||H.src},meta:{unoptimized:h,priority:x,placeholder:k,fill:v}}}},12538:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{default:function(){return f},defaultHead:function(){return u}});let a=s(87946),r=s(90692),i=s(62901),n=r._(s(24383)),l=a._(s(36904)),c=s(4490),o=s(24021),d=s(23149);function u(e){void 0===e&&(e=!1);let t=[(0,i.jsx)("meta",{charSet:"utf-8"})];return e||t.push((0,i.jsx)("meta",{name:"viewport",content:"width=device-width"})),t}function m(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===n.default.Fragment?e.concat(n.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}s(59882);let h=["name","httpEquiv","charSet","itemProp"];function x(e,t){let{inAmpMode:s}=t;return e.reduce(m,[]).reverse().concat(u(s).reverse()).filter(function(){let e=new Set,t=new Set,s=new Set,a={};return r=>{let i=!0,n=!1;if(r.key&&"number"!=typeof r.key&&r.key.indexOf("$")>0){n=!0;let t=r.key.slice(r.key.indexOf("$")+1);e.has(t)?i=!1:e.add(t)}switch(r.type){case"title":case"base":t.has(r.type)?i=!1:t.add(r.type);break;case"meta":for(let e=0,t=h.length;e<t;e++){let t=h[e];if(r.props.hasOwnProperty(t)){if("charSet"===t)s.has(t)?i=!1:s.add(t);else{let e=r.props[t],s=a[t]||new Set;("name"!==t||!n)&&s.has(e)?i=!1:(s.add(e),a[t]=s)}}}}return i}}()).reverse().map((e,t)=>{let a=e.key||t;if(!s&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(t=>e.props.href.startsWith(t))){let t={...e.props||{}};return t["data-href"]=t.href,t.href=void 0,t["data-optimized-fonts"]=!0,n.default.cloneElement(e,t)}return n.default.cloneElement(e,{key:a})})}let f=function(e){let{children:t}=e,s=(0,n.useContext)(c.AmpStateContext),a=(0,n.useContext)(o.HeadManagerContext);return(0,i.jsx)(l.default,{reduceComponentsToState:x,headManager:a,inAmpMode:(0,d.isInAmpMode)(s),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},55335:(e,t)=>{"use strict";function s(e){let{widthInt:t,heightInt:s,blurWidth:a,blurHeight:r,blurDataURL:i,objectFit:n}=e,l=a?40*a:t,c=r?40*r:s,o=l&&c?"viewBox='0 0 "+l+" "+c+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+o+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(o?"none":"contain"===n?"xMidYMid":"cover"===n?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+i+"'/%3E%3C/svg%3E"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImageBlurSvg",{enumerable:!0,get:function(){return s}})},40440:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{VALID_LOADERS:function(){return s},imageConfigDefault:function(){return a}});let s=["default","imgix","cloudinary","akamai","custom"],a={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"inline",localPatterns:void 0,remotePatterns:[],qualities:void 0,unoptimized:!1}},24169:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{default:function(){return c},getImageProps:function(){return l}});let a=s(87946),r=s(55653),i=s(42371),n=a._(s(83198));function l(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,s]of Object.entries(t))void 0===s&&delete t[e];return{props:t}}let c=i.Image},83198:(e,t)=>{"use strict";function s(e){var t;let{config:s,src:a,width:r,quality:i}=e,n=i||(null==(t=s.qualities)?void 0:t.reduce((e,t)=>Math.abs(t-75)<Math.abs(e-75)?t:e))||75;return s.path+"?url="+encodeURIComponent(a)+"&w="+r+"&q="+n}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}}),s.__next_img_default=!0;let a=s},36904:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let a=s(24383),r=()=>{},i=()=>{};function n(e){var t;let{headManager:s,reduceComponentsToState:n}=e;function l(){if(s&&s.mountedInstances){let t=a.Children.toArray(Array.from(s.mountedInstances).filter(Boolean));s.updateHead(n(t,e))}}return null==s||null==(t=s.mountedInstances)||t.add(e.children),l(),r(()=>{var t;return null==s||null==(t=s.mountedInstances)||t.add(e.children),()=>{var t;null==s||null==(t=s.mountedInstances)||t.delete(e.children)}}),r(()=>(s&&(s._pendingUpdate=l),()=>{s&&(s._pendingUpdate=l)})),i(()=>(s&&s._pendingUpdate&&(s._pendingUpdate(),s._pendingUpdate=null),()=>{s&&s._pendingUpdate&&(s._pendingUpdate(),s._pendingUpdate=null)})),null}},8125:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(88895).createProxy)(String.raw`/home/ubuntu/naggery_app/app/app/security/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[372,446,134,921],()=>s(77450));module.exports=a})();